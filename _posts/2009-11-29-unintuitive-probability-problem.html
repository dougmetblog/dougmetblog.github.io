---
layout: post
title: An unintuitive probability problem
date: '2009-11-29T12:53:00.027Z'
author: Douglas Ashton
tags:
- probability
- stat-mech
modified_time: '2009-12-01T10:50:17.661Z'
thumbnail: http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRMB4P0WyI/AAAAAAAABS4/VO3GCz-3Bo8/s72-c/pl.png
blogger_id: tag:blogger.com,1999:blog-5457514384557268934.post-4333046268586169958
blogger_orig_url: http://www.kineticallyconstrained.com/2009/11/unintuitive-probability-problem.html
---

Probability can do strange things to your mind. This week I had a probability problem where every time I tried to use intuition to solve it I ended up going completely wrong. I thought I'd share it as I think it's interesting.<br /><br />Consider a one dimensional random walk. At each time step my walker will go left with probability <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410032647541119778" src="http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRMB4P0WyI/AAAAAAAABS4/VO3GCz-3Bo8/s200/pl.png" style="cursor: pointer; height: 11px; width: 12px;" />, and right with probability <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410033025805308338" src="http://3.bp.blogspot.com/_zWFdJl7vhzA/SxRMX5ZB0bI/AAAAAAAABTA/GFtkE9Xgj9c/s200/pr.png" style="cursor: pointer; height: 11px; width: 15px;" />. It stays where it is with probability <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410033376303173986" src="http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRMsTGO0WI/AAAAAAAABTI/kAKY8v1Z-RA/s200/oneminplpr.png" style="cursor: pointer; height: 15px; width: 73px;" />. Furthermore these probabilities are dependent on the walker's position in space, so it's really <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410033750678892018" src="http://1.bp.blogspot.com/_zWFdJl7vhzA/SxRNCFwW7fI/AAAAAAAABTQ/UP5hrgUgO1g/s200/plx.png" style="cursor: pointer; height: 15px; width: 34px;" /> and <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410033894964215282" src="http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRNKfQqPfI/AAAAAAAABTY/j9W313V-s5o/s200/prx.png" style="cursor: pointer; height: 17px; width: 36px;" />. I'm imagining I'm on a finite line of length, L, although it doesn't matter too much.<br /><br />Now if <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410034315018456418" src="http://3.bp.blogspot.com/_zWFdJl7vhzA/SxRNi8FZTWI/AAAAAAAABTg/5iGnt24mKBA/s200/xlconst.png" style="cursor: pointer; height: 17px; width: 173px;" />, then we just have a normal random walker. In my problem I have the following setup: <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410034728139677490" src="http://4.bp.blogspot.com/_zWFdJl7vhzA/SxRN6_FK3zI/AAAAAAAABTo/lh3ybf0AqD8/s200/lmtx.png" style="cursor: pointer; height: 17px; width: 92px;" /> but <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410035019895088450" src="http://3.bp.blogspot.com/_zWFdJl7vhzA/SxROL99FJUI/AAAAAAAABTw/fDzRzRLxcHw/s200/plxp1r.png" style="cursor: pointer; height: 17px; width: 119px;" />. What does this mean? At any given point, x, my walker is more likely to go left than right. If it does go left it will come back with the same rate (although it's more likely to go left again).<br /><br /><br /><center><a bitly="BITLY_PROCESSED" href="http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRTWRyW-fI/AAAAAAAABUA/5t0_5GnoSCw/s1600/rw.png" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5410040694575659506" src="http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRTWRyW-fI/AAAAAAAABUA/5t0_5GnoSCw/s320/rw.png" style="cursor: pointer; height: 111px; width: 320px;" /></a></center><br /><br />So here's the question: If I leave this for a really long time, what is the equilibrium probability distribution for the walkers position, <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410035534600848322" src="http://1.bp.blogspot.com/_zWFdJl7vhzA/SxROp7Yfw8I/AAAAAAAABT4/zhYjrUrz8hM/s200/Px.png" style="cursor: pointer; height: 17px; width: 33px;" />?<br /><br /><a name='more'></a><br /><br /><span style="font-weight: bold;">Intuitive answer (1)</span><br />At any given site the chances are you are more likely to go left than right. Therefore, this introduces a bias to go left. The walker is more likely to be on the left hand side of the line after a long time.<br /><br /><span style="font-weight: bold;">Intuitive answer (2)</span><br />Because the transition rates are much faster on the left than the right, if the walker happens to go to the left it will much more quickly return. If the walker happens to go right then it's going  to take a long time to return. Therefore you're more likely to find it on the right.<br /><br /><span style="font-weight: bold;">The correct answer</span><br />Well it's a little of both. The correct answer is that there is equal probability of finding the walker absolutely anywhere. The reason for this does not come from intuition. At equilibrium we have the condition that there must be no probability "current". That is to say that the probability of being found at a given site must not change in time. This can be expressed mathematically by the master equation (if you don't want to do the maths we'll meet back at the end):<br /><br /><a bitly="BITLY_PROCESSED" href="http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRX3-kc2LI/AAAAAAAABUY/42TxrW8GAWM/s1600/Master1.png" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5410045671579113650" src="http://2.bp.blogspot.com/_zWFdJl7vhzA/SxRX3-kc2LI/AAAAAAAABUY/42TxrW8GAWM/s320/Master1.png" style="cursor: pointer; height: 54px; width: 320px;" /></a><br /><br />You have to think of the ps as rates for this to work. In our case we have that the rate for going left or right is the same as making the reverse move. The master equation then reduces to<br /><br /><a bitly="BITLY_PROCESSED" href="http://3.bp.blogspot.com/_zWFdJl7vhzA/SxRq-sbm2_I/AAAAAAAABU4/q6TiXfok-M4/s1600/master2-fix.png" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5410066677690194930" src="http://3.bp.blogspot.com/_zWFdJl7vhzA/SxRq-sbm2_I/AAAAAAAABU4/q6TiXfok-M4/s320/master2-fix.png" style="cursor: pointer; height: 18px; width: 320px;" /></a><br /><br />and the solution is that <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410042315154980610" src="http://1.bp.blogspot.com/_zWFdJl7vhzA/SxRU0m6k_wI/AAAAAAAABUI/YSw6DkZnVQc/s200/Pxconst.png" style="cursor: pointer; height: 16px;" />. So how does this sit with our intuitive ideas above? Well perhaps it's best to look at a trace of such a random walk. In the below example we have that <img alt="" border="0" id="BLOGGER_PHOTO_ID_5410042809230800866" src="http://3.bp.blogspot.com/_zWFdJl7vhzA/SxRVRXfbt-I/AAAAAAAABUQ/SeQ7fJ9bMy8/s200/pxsim.png" style="cursor: pointer; height: 18px;" />. What happens is that the walker does indeed move quickly at small x and slowly at large x (as in intuitive answer 2), but the slowness at large x seems to reflect the walker away. When it does manage to penetrate the barrier it takes a long time to come back. The average behaviour is that every site, x, is occupied for the same amount of time.<br /><br /><a bitly="BITLY_PROCESSED" href="http://1.bp.blogspot.com/_zWFdJl7vhzA/SxRej8k_UHI/AAAAAAAABUw/BUhLsDVcvVk/s1600/rwsimulation.png" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img alt="" border="0" id="BLOGGER_PHOTO_ID_5410053024028512370" src="http://1.bp.blogspot.com/_zWFdJl7vhzA/SxRej8k_UHI/AAAAAAAABUw/BUhLsDVcvVk/s400/rwsimulation.png" style="cursor: pointer; height: 274px; width: 400px;" /></a><br /><br />So there it is. Never trust your instincts when it comes to probability, well not mine at least.<br /><br />Oh, and on a separate note, putting maths into a blog post is a bloody nightmare - any ideas?<br />EDIT: Some maths fixed...